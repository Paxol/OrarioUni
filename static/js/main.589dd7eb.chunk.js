(this.webpackJsonporario_elly=this.webpackJsonporario_elly||[]).push([[0],{31:function(e,t,n){e.exports=n(45)},36:function(e,t,n){},45:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(6),o=n.n(i),c=(n(36),n(8)),l=n(7),u=n(5),s=n.n(u);function d(e){if(e)return e.celle.map((function(e){return{data:s()(e.data.split("-").reverse().join("-")),nome_insegnamento:e.nome_insegnamento,inizio:e.ora_inizio,fine:e.ora_fine,id_insegnamento:e.codice_insegnamento}}))}function m(e){var t=d(e);if(t){var n=t.filter((function(e){return s()().isSame(e.data,"day")}));return n.sort((function(e,t){return e.inizio<t.inizio?-1:0})),n}}function p(e){var t=d(e);if(t){var n=t.filter((function(e){return e.data.isAfter(s()())&&s()().isSame(e.data,"week")}));return n.sort((function(e,t){return e.data.isBefore(t.data)?-1:e.data.isSame(t.data,"day")?e.inizio<t.inizio?-1:0:1})),n}}function f(e){var t=d(e);if(t){var n=t.filter((function(e){return s()().add(1,"week").isSame(e.data,"week")}));return n.sort((function(e,t){return e.data.isBefore(t.data)?-1:e.data.isSame(t.data,"day")?e.inizio<t.inizio?-1:0:1})),n}}function g(e){var t=d(e);if(t){var n=t.filter((function(e){return e.data.isAfter(s()().endOf("week"))}));return n.sort((function(e,t){return e.data.isBefore(t.data)?-1:e.data.isSame(t.data,"day")?e.inizio<t.inizio?-1:0:1})),n}}var h=n(10),v=n(22),E=Object(h.c)((function(e,t){switch(console.log(t),t.type){case"orario_elly/data/CHANGE_DATA":return t.payload;default:return e}}),Object(h.a)(v.a)),b=n(11),y=n.n(b),_=n(18),w=n(24),j=n(27),O=n(48),z=n(49),S=n(23),k=function e(){var t=this;Object(S.a)(this,e),this.getData=function(){if(!t.data){var n=localStorage.getItem(e.name);t.data=n?JSON.parse(n):{}}return t.data},this.setData=function(n,a){t.data[n]=a,localStorage.setItem(e.name,JSON.stringify(t.data))},this.getTipologia=function(e){return t.data[e]},this.getString=function(t){return e.values[t]||""},this.data=void 0};k.values=["","In diretta","Video su Elly"];var x,N=Object(a.createContext)(null),C=k,D=function(){var e=Object(_.a)(y.a.mark((function e(t){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.showNotificationWithTrigger(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),L=function(){var e=Object(_.a)(y.a.mark((function e(t){var n,a,r,i,o,l,u,d,m;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0,a=0;case 2:if(!(a<t.length)){e.next=14;break}return r=t[a],i=r.inizio.split(":"),o=Object(c.a)(i,2),l=o[0],u=o[1],d=s()(r.data).add(l,"hours").add(u-5,"minutes").unix(),m={tag:d,body:"Lezione di ".concat(r.nome_insegnamento," alle ").concat(l,":").concat(u),badge:"./logo192.png",icon:"./logo192.png"},e.next=9,D(m);case 9:e.sent&&n++;case 11:a++,e.next=2;break;case 14:return e.abrupt("return",[n,t.length]);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),A=(x=function(e){var t=e.orari,n=e.categorieLezioni;return r.a.createElement(z.a,{striped:!0,bordered:!0,hover:!0,responsive:!0},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Data"),r.a.createElement("th",null,"Insegnamento"),r.a.createElement("th",null,"Orario"),r.a.createElement("th",null,"Modalit\xe0 lezione"))),r.a.createElement("tbody",null,t.map((function(e,t){return r.a.createElement(T,{key:t,orario:e,categoriaSelezionata:n.getTipologia(e.id_insegnamento),handleChangeCategoria:function(t){return n.setData(e.id_insegnamento,t)}})}))))},function(e){return r.a.createElement(N.Consumer,null,(function(t){return r.a.createElement(x,Object.assign({},e,{categorieLezioni:t}))}))}),T=function(e){var t=e.orario,n=t.data,a=t.nome_insegnamento,i=t.inizio,o=t.fine,c=e.categoriaSelezionata,l=e.handleChangeCategoria;return r.a.createElement("tr",null,r.a.createElement("td",null,n&&n.format("DD/MM/YYYY")),r.a.createElement("td",null,a),r.a.createElement("td",null,i," - ",o),r.a.createElement("td",null,r.a.createElement("select",{value:c,onChange:function(e){var t=e.target.value;l(t)}},C.values.map((function(e,t){return r.a.createElement("option",{key:t,value:t},e)})))))},I=Object(l.b)((function(e){return{isDataLoaded:null!=e}}),{fetchAPI:function(){return function(e){var t=new Headers;t.append("x-requested-with","XMLHttpRequest"),t.append("content-type","application/x-www-form-urlencoded; charset=UTF-8");var n=new URLSearchParams;return n.append("view","easycourse"),n.append("form-type","corso"),n.append("include","corso"),n.append("txtcurr","2 anno - Generale"),n.append("anno","2020"),n.append("corso","3050"),n.append("anno2[]","GEN|2"),n.append("date","21-09-2020"),n.append("periodo_didattico",""),n.append("_lang","it"),n.append("list","0"),n.append("week_grid_type","-1"),n.append("ar_codes_",""),n.append("ar_select_",""),n.append("col_cells","0"),n.append("empty_box","0"),n.append("only_grid","0"),n.append("highlighted_date","0"),n.append("all_events","0"),n.append("faculty_group","0"),n.append("all_events","1"),fetch("https://cors-anywhere.herokuapp.com/https://agendastudenti.unipr.it/grid_call.php",{method:"POST",headers:t,body:n,redirect:"follow"}).then((function(e){return e.json()})).then((function(t){return e({type:"orario_elly/data/CHANGE_DATA",payload:t})})).catch((function(e){return console.error(e)}))}}})((function(e){var t=e.isDataLoaded,n=e.fetchAPI,i=Object(a.useState)({message:void 0,type:void 0}),o=Object(c.a)(i,2),u=o[0],s=o[1],d=Object(a.useState)(void 0),h=Object(c.a)(d,2),v=h[0],E=h[1],b=Object(l.c)(m),y=Object(l.c)(p),_=Object(l.c)(f),z=Object(l.c)(g),S=function(){s({message:void 0,type:void 0}),E(void 0)};Object(a.useEffect)((function(){t||n()}),[t,n]),Object(a.useEffect)((function(){if(u.message){v&&clearTimeout(v);var e=setTimeout(S,2500);E(e)}}),[u]);var k=function(e){L(e).then((function(e){var t,n=Object(c.a)(e,2),a=n[0],r=n[1];t=0===a?"danger":a>0&&a<r?"warning":"success",s({message:"Programmati ".concat(a,"/").concat(r," promemoria"),type:t})}))};return r.a.createElement(w.a,{className:"mt-3"},t?r.a.createElement(r.a.Fragment,null,r.a.createElement(j.a,{show:void 0!==u.type,variant:u.type},r.a.createElement("p",null,u.message)),r.a.createElement("div",{className:"d-flex justify-content-between align-items-center"},r.a.createElement("h1",null,"Lezioni di oggi"),r.a.createElement(O.a,{onClick:function(){k(b)}},"Ricordamelo")),b&&b.length>0?r.a.createElement(A,{orari:b}):r.a.createElement("div",null,"Non ci sono lezioni per oggi"),r.a.createElement("hr",null),r.a.createElement("div",{className:"d-flex justify-content-between align-items-center"},r.a.createElement("h2",null,"Lezioni della settimana"),r.a.createElement(O.a,{onClick:function(){k(y)}},"Ricordamelo")),y&&y.length>0?r.a.createElement(A,{orari:y}):r.a.createElement("div",null,"Non ci sono altre lezioni per questa settimana"),r.a.createElement("hr",null),r.a.createElement("div",{className:"d-flex justify-content-between align-items-center"},r.a.createElement("h2",null,"Lezioni settimana prossima"),r.a.createElement(O.a,{onClick:function(){k(_)}},"Ricordamelo")),_&&_.length>0?r.a.createElement(A,{orari:_}):r.a.createElement("div",null,"Non ci sono lezioni per settimana prossima"),r.a.createElement("hr",null),r.a.createElement("h3",null,"Lezioni successive"),z&&z.length>0?r.a.createElement(A,{orari:z}):r.a.createElement("div",null,"Non ci sono altre lezioni")):r.a.createElement("h1",null,"Caricamento..."))}));var P=function(){var e=Object(a.useState)(new C),t=Object(c.a)(e,1)[0];return Object(a.useEffect)((function(){t&&t.getData()})),r.a.createElement(N.Provider,{value:t},r.a.createElement(l.a,{store:E},r.a.createElement(I,null)))};n(44);o.a.render(r.a.createElement(P,null),document.getElementById("root"))}},[[31,1,2]]]);
//# sourceMappingURL=main.589dd7eb.chunk.js.map